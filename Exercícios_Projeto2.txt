CREATE DATABASE LIVRARIA;
USE LIVRARIA;

/* CRIANDO A TABELA LIVROS */

CREATE TABLE LIVROS(
IDLIVRO INT PRIMARY KEY AUTO_INCREMENT,
TITULO VARCHAR(30),
AUTOR VARCHAR(30),
SEXO_AUTOR CHAR(1),
PAGINAS INT(4),
EDITORA VARCHAR(30),
VALOR FLOAT(10,2),
UF_EDITORA CHAR(2),
ANO INT(4)
);

/* INSERINDO VALORES NA TABELA */

INSERT INTO LIVROS(TITULO,AUTOR,SEXO_AUTOR,PAGINAS,EDITORA,VALOR,UF_EDITORA,ANO) VALUES('CAVALEIRO REAL','ANA CLAUDIA','F','465','ATLAS',49.9,'RJ','2009');
INSERT INTO LIVROS(TITULO,AUTOR,SEXO_AUTOR,PAGINAS,EDITORA,VALOR,UF_EDITORA,ANO) VALUES('SQL PARA LEIGOS','JOAO NUNES','M','450','ADDISON',98,'SP','2018');
INSERT INTO LIVROS(TITULO,AUTOR,SEXO_AUTOR,PAGINAS,EDITORA,VALOR,UF_EDITORA,ANO) VALUES('RECEITAS CASEIRAS','CELIA TAVARES','F','210','ATLAS',45,'RJ','2008');
INSERT INTO LIVROS(TITULO,AUTOR,SEXO_AUTOR,PAGINAS,EDITORA,VALOR,UF_EDITORA,ANO) VALUES('PESSOAS EFETIVAS','EDUARDO SANTOS','M','390','BETA',78.99,'RJ','2018');
INSERT INTO LIVROS(TITULO,AUTOR,SEXO_AUTOR,PAGINAS,EDITORA,VALOR,UF_EDITORA,ANO) VALUES('HABITOS SAUDAVEIS','EDUARDO SANTOS','M','630','BETA',150.98,'RJ','2019');
INSERT INTO LIVROS(TITULO,AUTOR,SEXO_AUTOR,PAGINAS,EDITORA,VALOR,UF_EDITORA,ANO) VALUES('A CASA MARROM','HERMES MACEDO','M','250','BUBBA',60,'MG','2016');
INSERT INTO LIVROS(TITULO,AUTOR,SEXO_AUTOR,PAGINAS,EDITORA,VALOR,UF_EDITORA,ANO) VALUES('ESTACIO QUERIDO','GERALDO FRANCISCO','M','310','INSIGNIA',100,'ES','2015');
INSERT INTO LIVROS(TITULO,AUTOR,SEXO_AUTOR,PAGINAS,EDITORA,VALOR,UF_EDITORA,ANO) VALUES('PARA SEMPRE AMIGAS','LEDA SILVA','F','510','INSIGNIA',78.98,'ES','2011');
INSERT INTO LIVROS(TITULO,AUTOR,SEXO_AUTOR,PAGINAS,EDITORA,VALOR,UF_EDITORA,ANO) VALUES('COPAS INESQUECIVEIS','MARCO ALCANTARA','M','200','LARSON',130.98,'RS','2018');
INSERT INTO LIVROS(TITULO,AUTOR,SEXO_AUTOR,PAGINAS,EDITORA,VALOR,UF_EDITORA,ANO) VALUES('O PODER DA MENTE','CLARA MAFRA','F','120','CONTINENTAL',56.58,'SP','2017');

/* 1- TRAZER TODOS OS DADOS */

SELECT IDLIVRO,TITULO,AUTOR,SEXO_AUTOR,PAGINAS,EDITORA,VALOR,UF_EDITORA,ANO FROM LIVROS;

/* 2- TRAZER O NOME DO LIVRO E O NOME DA EDITORA */

SELECT TITULO,EDITORA
FROM LIVROS;

/* 3- TRAZER O NOME DO LIVRO E A UF DOS LIVROS PUBLICADOS POR AUTORES DO SEXO MASCULINO */

SELECT TITULO,UF_EDITORA 
FROM LIVROS
WHERE SEXO_AUTOR = 'M';

/* 4- TRAZER O NOME DO LIVRO E O NÚMERO DE PÁGINAS DOS LIVROS PUBLICADOS POR AUTORES DO SEXO FEMININO */

SELECT TITULO,PAGINAS
FROM LIVROS
WHERE SEXO_AUTOR = 'F';

/* 5- TRAZER OS VALORES DOS LIVROS DAS EDITORAS DE SÃO PAULO */

SELECT TITULO,VALOR
FROM LIVROS
WHERE UF_EDITORA = 'SP';

/* 6- TRAZER OS DADOS DOS AUTORES DO SEXO MASCULINO QUE TIVERAM LIVROS PUBLICADOS POR SÃO PAULO OU RIO DE JANEIRO (QUESTÃO DESAFIO) */

SELECT AUTOR, SEXO_AUTOR, UF_EDITORA
FROM LIVROS
WHERE
SEXO_AUTOR = 'M' AND (UF_EDITORA = 'SP' OR UF_EDITORA = 'RJ');

/* PERFOMANCE */

SELECT COUNT(*) FUNCIONARIOS;

--Traga os funcionarios que trabalhem 
--no departamento de filmes OU no 
--departamento de roupas */

--21 FILMES / 53 ROUPAS

SELECT COUNT(*), DEPARTAMENTO
FROM FUNCIONARIOS
GROUP BY DEPARTAMENTO;

SELECT * FROM FUNCIONARIOS
WHERE DEPARTAMENTO = 'ROUPAS'
OR
DEPARTAMENTO = 'FILMES';

-- O gestor de marketing pediu a lista das funcionarias que trabalhem no departamento 
--de filmes ou no departamento lar. Ele necessita enviar um email para as colaboradoras
--desses dois setores.

SELECT COUNT(*), SEXO
FROM FUNCIONARIOS
GROUP BY SEXO;
--FEMININO 491 OCORRENCIAS

SELECT COUNT(*), DEPARTAMENTO
FROM FUNCIONARIOS
GROUP BY DEPARTAMENTO;
--52 LAR, 21 FILMES.

SELECT * FROM FUNCIONARIOS
WHERE
( DEPARTAMENTO = 'LAR' AND SEXO = 'FEMININO' )
OR
( DEPARTAMENTO = 'FILMES' AND SEXO = 'FEMININO' );

--Traga os funcionarios do sexo masculino
--ou os funcionarios que trabalhem no Jardim

SELECT COUNT(*), DEPARTAMENTO
FROM FUNCIONARIOS
GROUP BY DEPARTAMENTO;
--47 OCORRENCIAS EM DEPARTAMENTO = 'JARDIM' CONTRA VARIOS OUTROS.

SELECT COUNT(*), SEXO
FROM FUNCIONARIOS
GROUP BY SEXO;

--484 OCORRENCIAS EM DEPARTAMENTO = 'MASCULINO' CONTRA 491 FEMININO

--HÁ MAIS OCORRENCIAS DE SEXO = 'M' DO QUE DEPARTAMENTO = 'JARDIM' EM RELACAO AS OUTRAS
--OCORRENCIAS DA MESMA COLUNA.

--ENTAO:

SELECT NOME
FROM FUNCIONARIOS
WHERE SEXO = 'MASCULINO'
OR DEPARTAMENTO = 'JARDIM';